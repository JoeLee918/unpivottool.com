# Excel Tools PRD Document (Updated)

## é¡¹ç›®æ¦‚è¿°
åŸºäºç°æœ‰ unpivottool.com æ‰©å±•å››ä¸ªExcelè¾…åŠ©å·¥å…·ï¼Œå½¢æˆå·¥å…·çŸ©é˜µï¼Œæå‡ç½‘ç«™ä»·å€¼å’Œç”¨æˆ·ç•™å­˜ã€‚åŒæ—¶è¿›è¡Œç½‘ç«™æ¶æ„é‡æ„ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’ŒSEOè¡¨ç°ã€‚

---

## ç½‘ç«™é‡æ„è§„åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šç½‘ç«™æ¶æ„è§„åˆ’ï¼ˆ1-2å¤©ï¼‰

#### æ–°ç½‘ç«™ç»“æ„
```
æ ¹ç›®å½• (/)
â”œâ”€â”€ ä¸»é¡µ (/)                    - æ ¸å¿ƒä»·å€¼å±•ç¤ºå’Œå¿«é€Ÿå¼€å§‹
â”œâ”€â”€ åŸå·¥å…·é¡µé¢ (/unpivot-tool)    - å®é™…åŠŸèƒ½é¡µé¢
â”œâ”€â”€ Excelå·¥å…·é›† (/excel-tools)    - æ–°å·¥å…·çŸ©é˜µé¡µé¢
â”‚   â”œâ”€â”€ /excel-tools/spotlight     # èšå…‰ç¯å·¥å…·
â”‚   â”œâ”€â”€ /excel-tools/text-grouper  # æ–‡æœ¬èšåˆå·¥å…·  
â”‚   â”œâ”€â”€ /excel-tools/filter-counter # ç­›é€‰è®¡æ•°å·¥å…·
â”‚   â””â”€â”€ /excel-tools/cell-fill     # å•å…ƒæ ¼å¡«å……å·¥å…·
â”œâ”€â”€ ä½¿ç”¨æŒ‡å— (/guide)           - è¯¦ç»†æ•™ç¨‹å’Œæœ€ä½³å®è·µ
â”‚   â”œâ”€â”€ /guide/getting-started
â”‚   â”œâ”€â”€ /guide/excel-vs-power-query
â”‚   â”œâ”€â”€ /guide/data-preparation
â”‚   â””â”€â”€ /guide/excel-tools-overview  # æ–°å¢ï¼šExcelå·¥å…·ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ åšå®¢ä¸­å¿ƒ (/resources)       - å­¦ä¹ èµ„æºå’Œæ¡ˆä¾‹
â”‚   â”œâ”€â”€ /resources/wide-vs-long-format
â”‚   â”œâ”€â”€ /resources/when-to-unpivot
â”‚   â”œâ”€â”€ /resources/success-stories
â”‚   â””â”€â”€ /resources/excel-productivity-tips  # æ–°å¢ï¼šExcelæ•ˆç‡æå‡
â”œâ”€â”€ FAQé¡µé¢ (/faq)              - å¸¸è§é—®é¢˜
â””â”€â”€ å…³äºæˆ‘ä»¬ (/about)           - å›¢é˜Ÿå’ŒæŠ€æœ¯èƒŒæ™¯
```

#### å…³é”®è¯åˆ†é…ç­–ç•¥
* **Homepage**ï¼š`unpivot tool`, `excel data converter`, `excel data tools`
* **Original Tool Page**ï¼š`online unpivot`, `convert wide to long format`
* **Excel Tools Suite**ï¼š`excel productivity tools`, `excel data analysis tools`
* **Guide Pages**ï¼š`how to unpivot data`, `excel unpivot tutorial`, `excel tools guide`
* **Blog Pages**ï¼š`data transformation best practices`, `unpivot vs pivot table`

### ç¬¬äºŒé˜¶æ®µï¼šå†…å®¹é‡æ–°åˆ†é…ï¼ˆ2-3å¤©ï¼‰

#### Homepage Content Streamlining (Keep 20% of core content)
**Content to Keep:**
* Hero section (value proposition) + Excel Tools Suite preview
* 3-step workflow demonstration
* Quick demo (before/after tables)
* Core features introduction (expand to 6 selling points, including new tools)
* CTA buttons (pointing to original tool page + Excel Tools Suite)

**Content to Remove:**
* Detailed FAQ (move to dedicated FAQ page)
* Professional team introduction (move to About page)
* Technical depth content (move to guide pages)
* Blog-style articles (move to Resources page)

#### æ–°å»ºExcelå·¥å…·é›†é¡µé¢
**æ–°å»ºï¼š**`/excel-tools/index.html`
* 4ä¸ªå·¥å…·çš„æ¦‚è§ˆä»‹ç»
* æ¯ä¸ªå·¥å…·çš„æ ¸å¿ƒä»·å€¼å±•ç¤º
* ä½¿ç”¨åœºæ™¯å¯¹æ¯”è¡¨æ ¼
* å·¥å…·é—´çš„åŠŸèƒ½äº’è¡¥è¯´æ˜

### ç¬¬ä¸‰é˜¶æ®µï¼šå¯¼èˆªç³»ç»Ÿé‡æ„ï¼ˆ1-2å¤©ï¼‰

#### æ–°å¯¼èˆªèœå•è®¾è®¡
```html
<nav class="main-nav">
  <a href="/" class="nav-brand">ğŸ“Š UnpivotTool</a>
  <div class="nav-links">
    <a href="/unpivot-tool">Unpivot Data</a>
    <div class="dropdown">
      <a href="/excel-tools" class="dropdown-toggle">Excel Tools â–¼</a>
      <div class="dropdown-menu">
        <a href="/excel-tools/spotlight">ğŸ” Spotlight Highlighter</a>
        <a href="/excel-tools/text-grouper">ğŸ“Š Text Grouper</a>
        <a href="/excel-tools/filter-counter">ğŸ¯ Filter Counter</a>
        <a href="/excel-tools/cell-fill">ğŸ“ Cell Auto-Fill</a>
      </div>
    </div>
    <a href="/guide">Guide</a>
    <a href="/resources">Resources</a>
    <a href="/faq">FAQ</a>
    <a href="/about">About</a>
  </div>
</nav>
```

---

## Excelå·¥å…·è¯¦ç»†è§„åˆ’

## 1. Spotlight (èšå…‰ç¯é«˜äº®å·¥å…·)

### 1.1 äº§å“å®šä½
ç®€åŒ–Excelæ¡ä»¶æ ¼å¼è®¾ç½®çš„åœ¨çº¿å·¥å…·ï¼Œé€šè¿‡å¯è§†åŒ–äº¤äº’å®ç°æ•°æ®é«˜äº®æ˜¾ç¤ºã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½

#### æ–‡æœ¬é«˜äº®æ¨¡å¼
- ç”¨æˆ·ç‚¹å‡»è¡¨æ ¼ä¸­ä»»æ„æ–‡æœ¬å•å…ƒæ ¼
- æ‰€æœ‰ç›¸åŒæ–‡textè‡ªåŠ¨é«˜äº®æ˜¾ç¤º
- æ”¯æŒå¤šä¸ªä¸åŒæ–‡æœ¬åŒæ—¶é«˜äº®ï¼ˆä¸åŒé¢œè‰²ï¼‰
- å³ä¾§æ§åˆ¶é¢æ¿æ˜¾ç¤ºå·²é€‰æ‹©çš„é«˜äº®é¡¹ç›®

#### æ•°å€¼åŒºé—´é«˜äº®æ¨¡å¼
- è‡ªåŠ¨æ£€æµ‹æ•°å€¼åˆ—
- å°†æ•°å€¼èŒƒå›´å¹³å‡åˆ†ä¸º5ä¸ªåŒºé—´
- æ¯ä¸ªåŒºé—´åˆ†é…ä¸åŒé¢œè‰²ï¼ˆæ¸å˜è‰²è°±ï¼‰
- ç”¨æˆ·å¯è°ƒæ•´åŒºé—´è¾¹ç•Œ

### 1.3 å•†ä¸šæ¨¡å¼
- å®Œå…¨å…è´¹ä½¿ç”¨
- æ”¯æŒæ— é™åˆ¶é«˜äº®é¡¹ç›®
- æ”¯æŒå¯¼å‡ºå¸¦æ¡ä»¶æ ¼å¼çš„Excelæ–‡ä»¶

### 1.4 æŠ€æœ¯å®ç°

#### å‰ç«¯æ ¸å¿ƒä»£ç 
```javascript
class SpotlightTool {
    constructor() {
        this.highlightedItems = new Map();
        this.colorPalette = ['#FFE6CC', '#E6F3FF', '#E6FFE6', '#FFE6F3', '#F3E6FF'];
        this.maxHighlights = Infinity; // æ— é™åˆ¶
    }
    
    handleCellClick(cell) {
        const value = cell.textContent.trim();
        const dataType = this.detectDataType(value);
        
        if (dataType === 'text') {
            this.handleTextHighlight(value);
        } else if (dataType === 'number') {
            this.handleNumberRangeHighlight();
        }
    }
    
    addTextHighlight(text) {
        if (this.highlightedItems.size >= this.maxFreeHighlights && !this.isPremium) {
            this.showUpgradeModal();
            return;
        }
        
        const color = this.getNextColor();
        this.highlightedItems.set(text, { type: 'text', color: color });
        this.findAndHighlightCells(text, color);
    }
    
    // æ•°å€¼åŒºé—´è®¡ç®—
    calculateRanges(numbers, rangeCount = 5) {
        const min = Math.min(...numbers);
        const max = Math.max(...numbers);
        const step = (max - min) / rangeCount;
        
        return Array.from({ length: rangeCount }, (_, i) => ({
            min: min + (step * i),
            max: min + (step * (i + 1)),
            color: this.colorPalette[i]
        }));
    }
    
    // ç”ŸæˆExcelæ¡ä»¶æ ¼å¼è§„åˆ™
    generateConditionalFormatting() {
        const rules = [];
        this.highlightedItems.forEach((item, key) => {
            if (item.type === 'text') {
                rules.push({
                    type: 'cellIs',
                    operator: 'equal',
                    formula: `"${key}"`,
                    fill: { fgColor: { rgb: item.color.replace('#', '') } }
                });
            }
        });
        return rules;
    }
}
```

---

## 2. Text-Grouper (æ–‡æœ¬èšåˆå·¥å…·)

### 2.1 äº§å“å®šä½
å°†é‡å¤çš„æ–‡æœ¬æ•°æ®è¿›è¡Œåˆ†ç»„èšåˆï¼Œç±»ä¼¼äºæ•°æ®é€è§†è¡¨ä½†ä¸“é—¨å¤„ç†æ–‡æœ¬å†…å®¹ã€‚

### 2.2 æ ¸å¿ƒåŠŸèƒ½
- æŒ‰æŒ‡å®šåˆ—çš„æ–‡æœ¬å€¼è¿›è¡Œåˆ†ç»„
- å°†åŒç»„çš„å…¶ä»–æ–‡æœ¬åˆ—å†…å®¹ç”¨é€—å·è¿æ¥
- æ•°å€¼åˆ—è¿›è¡Œæ±‚å’Œæ“ä½œ
- æ”¯æŒå¤šçº§åˆ†ç»„
- **æ–°å¢ï¼šUnpivot TextåŠŸèƒ½** - ç”¨æˆ·è‡ªå®šä¹‰åˆ†éš”ç¬¦æ‹†åˆ†æ–‡æœ¬

### 2.3 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹
#### è¾“å…¥æ•°æ®ï¼š
| å§“å | éƒ¨é—¨ | æŠ€èƒ½ | å·¥èµ„ |
|------|------|------|------|
| å¼ ä¸‰ | IT | Java | 8000 |
| å¼ ä¸‰ | IT | Python | 0 |
| æå›› | HR | æ‹›è˜ | 6000 |
| æå›› | HR | åŸ¹è®­ | 0 |

#### è¾“å‡ºç»“æœï¼ˆæŒ‰å§“ååˆ†ç»„ï¼‰ï¼š
| Name | Department | Skills | Salary |
|------|------------|--------|--------|
| Zhang San | IT | Java,Python | 8000 |
| Li Si | HR | Recruiting,Training | 6000 |

#### Unpivot Textä½¿ç”¨åœºæ™¯ï¼š
**è¾“å…¥æ•°æ®ï¼š**
| Name | Skills |
|------|---------|
| John | Java;Python;React |
| Mary | SQL;Tableau;Excel |

**ç”¨æˆ·é€‰æ‹©åˆ†éš”ç¬¦ï¼š** `;`

**è¾“å‡ºç»“æœï¼š**
| Name | Skills |
|------|--------|
| John | Java |
| John | Python |
| John | React |
| Mary | SQL |
| Mary | Tableau |
| Mary | Excel |

### 2.4 æŠ€æœ¯å®ç°

#### æ ¸å¿ƒç®—æ³•
```javascript
class TextGrouper {
    constructor() {
        this.data = [];
        this.groupByColumns = [];
        this.aggregateColumns = [];
    }
    
    // ä¸»è¦åˆ†ç»„é€»è¾‘
    groupData(data, groupByColumns, aggregateColumns) {
        const grouped = new Map();
        
        data.forEach(row => {
            // ç”Ÿæˆåˆ†ç»„é”®
            const groupKey = groupByColumns.map(col => row[col]).join('|||');
            
            if (!grouped.has(groupKey)) {
                // åˆå§‹åŒ–åˆ†ç»„
                const newGroup = { ...row };
                aggregateColumns.forEach(col => {
                    if (this.isNumeric(row[col])) {
                        newGroup[col] = parseFloat(row[col]) || 0;
                    } else {
                        newGroup[col] = row[col] || '';
                    }
                });
                grouped.set(groupKey, newGroup);
            } else {
                // èšåˆæ•°æ®
                const existingGroup = grouped.get(groupKey);
                aggregateColumns.forEach(col => {
                    if (this.isNumeric(row[col])) {
                        existingGroup[col] += parseFloat(row[col]) || 0;
                    } else {
                        // æ–‡æœ¬èšåˆï¼šç”¨é€—å·è¿æ¥ï¼Œå»é‡
                        const existingTexts = existingGroup[col].split(',').filter(t => t.trim());
                        const newText = row[col];
                        if (newText && !existingTexts.includes(newText)) {
                            existingGroup[col] = existingTexts.concat(newText).join(',');
                        }
                    }
                });
            }
        });
        
        return Array.from(grouped.values());
    }
    
    // æ£€æµ‹æ•°å€¼ç±»å‹
    isNumeric(value) {
        return !isNaN(parseFloat(value)) && isFinite(value);
    }
    
    // æ–°å¢ï¼šUnpivot Text åŠŸèƒ½
    unpivotText(data, textColumn, delimiter = ',') {
        const result = [];
        
        data.forEach(row => {
            const textValue = row[textColumn];
            if (textValue && typeof textValue === 'string') {
                const splitValues = textValue.split(delimiter).map(v => v.trim()).filter(v => v);
                
                splitValues.forEach(splitValue => {
                    const newRow = { ...row };
                    newRow[textColumn] = splitValue;
                    result.push(newRow);
                });
            } else {
                // å¦‚æœæ²¡æœ‰å¯æ‹†åˆ†çš„æ–‡æœ¬ï¼Œä¿æŒåŸè¡Œ
                result.push({ ...row });
            }
        });
        
        return result;
    }
    
    // æ£€æµ‹å¯èƒ½çš„åˆ†éš”ç¬¦
    detectDelimiters(data, column) {
        const commonDelimiters = [',', ';', '|', '/', '\\', '-', ':', ' '];
        const delimiterCounts = new Map();
        
        data.slice(0, 100).forEach(row => { // åªæ£€æµ‹å‰100è¡Œ
            const value = row[column];
            if (typeof value === 'string') {
                commonDelimiters.forEach(delimiter => {
                    const count = (value.match(new RegExp('\\' + delimiter, 'g')) || []).length;
                    if (count > 0) {
                        delimiterCounts.set(delimiter, (delimiterCounts.get(delimiter) || 0) + count);
                    }
                });
            }
        });
        
        // æŒ‰ä½¿ç”¨é¢‘ç‡æ’åº
        return Array.from(delimiterCounts.entries())
            .sort((a, b) => b[1] - a[1])
            .map(([delimiter, count]) => ({ delimiter, count }));
    }
}
```

---

## 3. Filter-Counter (ç­›é€‰è®¡æ•°å·¥å…·)

### 3.1 äº§å“å®šä½
æ¨¡ä»¿WPSè¡¨æ ¼çš„ç­›é€‰åŠŸèƒ½ï¼Œåœ¨Excelæ•°æ®ç­›é€‰æ—¶æ˜¾ç¤ºæ¯ä¸ªé€‰é¡¹çš„æ•°é‡ç»Ÿè®¡ã€‚

### 3.2 æ ¸å¿ƒåŠŸèƒ½
- ä¸ºæ¯ä¸€åˆ—æ·»åŠ ç­›é€‰ä¸‹æ‹‰æ¡†
- ä¸‹æ‹‰æ¡†ä¸­æ˜¾ç¤ºæ¯ä¸ªå€¼åŠå…¶å‡ºç°æ¬¡æ•°
- æ”¯æŒå¤šåˆ—åŒæ—¶ç­›é€‰
- å®æ—¶æ›´æ–°ç­›é€‰ç»“æœå’Œè®¡æ•°

### 3.3 ç•Œé¢è®¾è®¡
```
åˆ—æ ‡é¢˜ â–¼ 
â”œâ”€â”€ â˜‘ å…¨é€‰ (æ€»è®¡: 1000)
â”œâ”€â”€ â˜‘ å¼ ä¸‰ (123)
â”œâ”€â”€ â˜‘ æå›› (89)
â”œâ”€â”€ â˜‘ ç‹äº” (234)
â””â”€â”€ â˜ èµµå…­ (67)
```

### 3.4 æŠ€æœ¯å®ç°

#### æ ¸å¿ƒä»£ç 
```javascript
class FilterCounter {
    constructor() {
        this.originalData = [];
        this.filteredData = [];
        this.filters = new Map(); // å­˜å‚¨æ¯åˆ—çš„ç­›é€‰çŠ¶æ€
    }
    
    // åˆå§‹åŒ–ç­›é€‰å™¨
    initializeFilters(data) {
        const headers = Object.keys(data[0]);
        this.originalData = data;
        this.filteredData = [...data];
        
        headers.forEach(header => {
            const valueCount = this.getValueCounts(data, header);
            this.createFilterDropdown(header, valueCount);
        });
    }
    
    // ç»Ÿè®¡æ¯ä¸ªå€¼çš„å‡ºç°æ¬¡æ•°
    getValueCounts(data, column) {
        const counts = new Map();
        data.forEach(row => {
            const value = row[column];
            counts.set(value, (counts.get(value) || 0) + 1);
        });
        
        // æŒ‰æ•°é‡æ’åº
        return new Map([...counts.entries()].sort((a, b) => b[1] - a[1]));
    }
    
    // åˆ›å»ºç­›é€‰ä¸‹æ‹‰æ¡†
    createFilterDropdown(column, valueCounts) {
        const dropdown = document.createElement('div');
        dropdown.className = 'filter-dropdown';
        
        // å…¨é€‰é€‰é¡¹
        const selectAll = this.createFilterOption(
            'select-all', 
            'å…¨é€‰', 
            this.originalData.length,
            true,
            () => this.handleSelectAll(column)
        );
        dropdown.appendChild(selectAll);
        
        // å„ä¸ªå€¼é€‰é¡¹
        valueCounts.forEach((count, value) => {
            const option = this.createFilterOption(
                value,
                value,
                count,
                true,
                () => this.handleFilterChange(column, value)
            );
            dropdown.appendChild(option);
        });
        
        return dropdown;
    }
    
    // åˆ›å»ºç­›é€‰é€‰é¡¹
    createFilterOption(value, displayText, count, checked, onChange) {
        const option = document.createElement('div');
        option.className = 'filter-option';
        option.innerHTML = `
            <label>
                <input type="checkbox" value="${value}" ${checked ? 'checked' : ''}>
                <span class="filter-text">${displayText}</span>
                <span class="filter-count">(${count})</span>
            </label>
        `;
        
        option.querySelector('input').addEventListener('change', onChange);
        return option;
    }
    
    // å¤„ç†ç­›é€‰å˜æ›´
    handleFilterChange(column, value) {
        if (!this.filters.has(column)) {
            this.filters.set(column, new Set());
        }
        
        const columnFilter = this.filters.get(column);
        if (columnFilter.has(value)) {
            columnFilter.delete(value);
        } else {
            columnFilter.add(value);
        }
        
        this.applyFilters();
        this.updateFilterCounts();
    }
    
    // åº”ç”¨ç­›é€‰
    applyFilters() {
        this.filteredData = this.originalData.filter(row => {
            return Array.from(this.filters.entries()).every(([column, selectedValues]) => {
                if (selectedValues.size === 0) return true; // æœªè®¾ç½®ç­›é€‰
                return selectedValues.has(row[column]);
            });
        });
        
        this.renderTable(this.filteredData);
    }
    
    // æ›´æ–°ç­›é€‰è®¡æ•°
    updateFilterCounts() {
        const headers = Object.keys(this.originalData[0]);
        headers.forEach(header => {
            const newCounts = this.getValueCounts(this.filteredData, header);
            this.updateDropdownCounts(header, newCounts);
        });
    }
}
```

---

## 4. Cell-Fill (å•å…ƒæ ¼æ‹†åˆ†åè‡ªåŠ¨å¡«å……å·¥å…·)

### 4.1 äº§å“å®šä½
è§£å†³Excelä¸­åˆå¹¶å•å…ƒæ ¼æ‹†åˆ†åéœ€è¦æ‰‹åŠ¨å¡«å……ç©ºç™½å•å…ƒæ ¼çš„é—®é¢˜ã€‚

### 4.2 æ ¸å¿ƒåŠŸèƒ½
- è‡ªåŠ¨æ£€æµ‹åˆå¹¶å•å…ƒæ ¼åŒºåŸŸ
- ä¸€é”®å¡«å……ç©ºç™½å•å…ƒæ ¼
- æ”¯æŒå‘ä¸‹å¡«å……å’Œå‘å³å¡«å……
- æ™ºèƒ½è¯†åˆ«å¡«å……æ¨¡å¼

### 4.3 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

#### é—®é¢˜åœºæ™¯ï¼ˆExcelæ‹†åˆ†åˆå¹¶å•å…ƒæ ¼åï¼‰ï¼š
| éƒ¨é—¨ | å§“å | èŒä½ |
|------|------|------|
| é”€å”®éƒ¨ | å¼ ä¸‰ | ç»ç† |
|      | æå›› | ä¸“å‘˜ |
|      | ç‹äº” | ä¸“å‘˜ |
| æŠ€æœ¯éƒ¨ | èµµå…­ | æ€»ç›‘ |
|      | é™ˆä¸ƒ | å·¥ç¨‹å¸ˆ |

#### è‡ªåŠ¨å¡«å……åï¼š
| éƒ¨é—¨ | å§“å | èŒä½ |
|------|------|------|
| é”€å”®éƒ¨ | å¼ ä¸‰ | ç»ç† |
| é”€å”®éƒ¨ | æå›› | ä¸“å‘˜ |
| é”€å”®éƒ¨ | ç‹äº” | ä¸“å‘˜ |
| æŠ€æœ¯éƒ¨ | èµµå…­ | æ€»ç›‘ |
| æŠ€æœ¯éƒ¨ | é™ˆä¸ƒ | å·¥ç¨‹å¸ˆ |

### 4.4 æŠ€æœ¯å®ç°

#### æ ¸å¿ƒç®—æ³•
```javascript
class CellFiller {
    constructor() {
        this.data = [];
        this.fillRules = [];
    }
    
    // ä¸»è¦å¡«å……é€»è¾‘
    autoFillCells(data) {
        const result = data.map(row => ({ ...row }));
        const headers = Object.keys(data[0]);
        
        headers.forEach(header => {
            this.fillColumnBlanks(result, header);
        });
        
        return result;
    }
    
    // å¡«å……å•åˆ—çš„ç©ºç™½å•å…ƒæ ¼
    fillColumnBlanks(data, columnName) {
        let lastValidValue = null;
        
        for (let i = 0; i < data.length; i++) {
            const currentValue = data[i][columnName];
            
            if (this.isEmpty(currentValue)) {
                // ç©ºç™½å•å…ƒæ ¼ï¼Œç”¨ä¸Šä¸€ä¸ªæœ‰æ•ˆå€¼å¡«å……
                if (lastValidValue !== null) {
                    data[i][columnName] = lastValidValue;
                }
            } else {
                // æ›´æ–°æœ€åä¸€ä¸ªæœ‰æ•ˆå€¼
                lastValidValue = currentValue;
            }
        }
    }
    
    // æ£€æµ‹ç©ºç™½å•å…ƒæ ¼
    isEmpty(value) {
        return value === null || 
               value === undefined || 
               value === '' || 
               (typeof value === 'string' && value.trim() === '');
    }
    
    // æ™ºèƒ½æ£€æµ‹å¡«å……æ¨¡å¼
    detectFillPattern(data) {
        const patterns = [];
        const headers = Object.keys(data[0]);
        
        headers.forEach(header => {
            const columnData = data.map(row => row[header]);
            const blankRanges = this.findBlankRanges(columnData);
            
            if (blankRanges.length > 0) {
                patterns.push({
                    column: header,
                    type: 'down-fill',
                    ranges: blankRanges
                });
            }
        });
        
        return patterns;
    }
    
    // æŸ¥æ‰¾ç©ºç™½åŒºåŸŸ
    findBlankRanges(columnData) {
        const ranges = [];
        let currentRange = null;
        
        columnData.forEach((value, index) => {
            if (this.isEmpty(value)) {
                if (!currentRange) {
                    currentRange = { start: index, end: index };
                } else {
                    currentRange.end = index;
                }
            } else {
                if (currentRange) {
                    ranges.push(currentRange);
                    currentRange = null;
                }
            }
        });
        
        // å¤„ç†æœ€åä¸€ä¸ªèŒƒå›´
        if (currentRange) {
            ranges.push(currentRange);
        }
        
        return ranges;
    }
    
    // é¢„è§ˆå¡«å……æ•ˆæœ
    previewFill(data) {
        const preview = this.autoFillCells(data);
        const changes = [];
        
        data.forEach((originalRow, rowIndex) => {
            const updatedRow = preview[rowIndex];
            Object.keys(originalRow).forEach(column => {
                if (this.isEmpty(originalRow[column]) && !this.isEmpty(updatedRow[column])) {
                    changes.push({
                        row: rowIndex,
                        column: column,
                        oldValue: originalRow[column],
                        newValue: updatedRow[column]
                    });
                }
            });
        });
        
        return { preview, changes };
    }
    
    // é«˜çº§å¡«å……é€‰é¡¹
    advancedFill(data, options = {}) {
        const {
            fillDirection = 'down', // 'down', 'right', 'both'
            selectedColumns = null,  // æŒ‡å®šåˆ—å¡«å……
            fillMethod = 'previous'  // 'previous', 'next', 'interpolate'
        } = options;
        
        let result = data.map(row => ({ ...row }));
        
        if (fillDirection === 'down' || fillDirection === 'both') {
            result = this.fillDown(result, selectedColumns, fillMethod);
        }
        
        if (fillDirection === 'right' || fillDirection === 'both') {
            result = this.fillRight(result, selectedColumns, fillMethod);
        }
        
        return result;
    }
    
    // å‘ä¸‹å¡«å……
    fillDown(data, columns = null, method = 'previous') {
        const targetColumns = columns || Object.keys(data[0]);
        const result = data.map(row => ({ ...row }));
        
        targetColumns.forEach(column => {
            if (method === 'previous') {
                this.fillColumnBlanks(result, column);
            } else if (method === 'next') {
                this.fillColumnBlanksFromNext(result, column);
            }
        });
        
        return result;
    }
    
    // ä½¿ç”¨ä¸‹ä¸€ä¸ªæœ‰æ•ˆå€¼å¡«å……
    fillColumnBlanksFromNext(data, columnName) {
        for (let i = data.length - 2; i >= 0; i--) {
            if (this.isEmpty(data[i][columnName]) && !this.isEmpty(data[i + 1][columnName])) {
                data[i][columnName] = data[i + 1][columnName];
            }
        }
    }
}
```

---

## 5. å…±ç”¨ç»„ä»¶è®¾è®¡

### 5.1 æ–‡ä»¶ç»“æ„
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ index.html                    (ä¸»é¡µ)
â”œâ”€â”€ unpivot-tool/
â”‚   â””â”€â”€ index.html               (åŸå·¥å…·é¡µé¢)
â”œâ”€â”€ excel-tools/
â”‚   â”œâ”€â”€ index.html               (å·¥å…·é›†åˆé¡µé¢)
â”‚   â”œâ”€â”€ spotlight/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ text-grouper/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ filter-counter/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â””â”€â”€ cell-fill/
â”‚       â””â”€â”€ index.html
â”œâ”€â”€ guide/
â”‚   â”œâ”€â”€ index.html               (æŒ‡å—ä¸­å¿ƒ)
â”‚   â”œâ”€â”€ getting-started.html
â”‚   â”œâ”€â”€ excel-vs-power-query.html
â”‚   â”œâ”€â”€ data-preparation.html
â”‚   â””â”€â”€ excel-tools-overview.html  # æ–°å¢
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ index.html               (èµ„æºä¸­å¿ƒ)
â”‚   â”œâ”€â”€ wide-vs-long-format.html
â”‚   â”œâ”€â”€ success-stories.html
â”‚   â””â”€â”€ excel-productivity-tips.html  # æ–°å¢
â”œâ”€â”€ faq/
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ about/
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ common.css           (å…±ç”¨æ ·å¼)
â”‚   â”‚   â””â”€â”€ tools.css            (å·¥å…·ä¸“ç”¨æ ·å¼)
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ common.js            (å…±ç”¨åŠŸèƒ½)
â”‚   â”‚   â””â”€â”€ file-handler.js      (æ–‡ä»¶å¤„ç†)
â”‚   â””â”€â”€ images/
â””â”€â”€ sitemap.xml
```

### 5.2 å…±ç”¨ç»„ä»¶
- ç»Ÿä¸€çš„æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
- ç»Ÿä¸€çš„è¡¨æ ¼æ¸²æŸ“ç»„ä»¶  
- ç»Ÿä¸€çš„ä¸‹è½½ç»„ä»¶
- ç»Ÿä¸€çš„UIæ ·å¼
- ç»Ÿä¸€çš„å¯¼èˆªå’Œé¢åŒ…å±‘ç»„ä»¶

### 5.3 SEOä¼˜åŒ–
æ¯ä¸ªå·¥å…·é¡µé¢åŒ…å«ï¼š
- ç‹¬ç‰¹çš„é¡µé¢æ ‡é¢˜å’Œæè¿°
- ç›¸å…³å…³é”®è¯ä¼˜åŒ–
- å·¥å…·é—´çš„å†…é“¾å¯¼èˆª
- ç»Ÿä¸€çš„é¢åŒ…å±‘å¯¼èˆª
- ç»“æ„åŒ–æ•°æ®æ ‡è®°

### 5.4 å†…éƒ¨é“¾æ¥ç­–ç•¥
**ä¸»é¡µé“¾æ¥ç­–ç•¥ï¼š**
* ä¸»CTAæŒ‡å‘ `/unpivot-tool`
* "Excelå·¥å…·é›†"æŒ‡å‘ `/excel-tools`
* "å­¦ä¹ æ›´å¤š"æŒ‡å‘ `/guide`

**Excelå·¥å…·é›†é¡µé¢é“¾æ¥ï¼š**
* æ¯ä¸ªå·¥å…·éƒ½æœ‰æŒ‡å‘è¯¦ç»†é¡µé¢çš„é“¾æ¥
* "ä½¿ç”¨æŒ‡å—"æŒ‡å‘ `/guide/excel-tools-overview`
* å·¥å…·é—´ç›¸äº’æ¨è

**å•ä¸ªå·¥å…·é¡µé¢é“¾æ¥ï¼š**
* "è¿”å›å·¥å…·é›†"æŒ‡å‘ `/excel-tools`
* "éœ€è¦å¸®åŠ©ï¼Ÿ"æŒ‡å‘ç›¸å…³æŒ‡å—é¡µé¢
* æ¨èå…¶ä»–ç›¸å…³å·¥å…·

### 5.5 æŠ€æœ¯æ ˆ
- å‰ç«¯ï¼šåŸç”ŸJavaScript (ä¿æŒä¸ç°æœ‰å·¥å…·ä¸€è‡´)
- æ–‡ä»¶å¤„ç†ï¼šSheetJS
- æ ·å¼ï¼šTailwind CSS
- éƒ¨ç½²ï¼šé™æ€æ‰˜ç®¡

---

## 6. å¼€å‘ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼šç½‘ç«™é‡æ„ï¼ˆ10-14å¤©ï¼‰
1. **ç½‘ç«™æ¶æ„è§„åˆ’**ï¼ˆ1-2å¤©ï¼‰
2. **å†…å®¹é‡æ–°åˆ†é…**ï¼ˆ2-3å¤©ï¼‰
3. **å¯¼èˆªç³»ç»Ÿé‡æ„**ï¼ˆ1-2å¤©ï¼‰
4. **å†…éƒ¨é“¾æ¥ç­–ç•¥å®æ–½**ï¼ˆ1å¤©ï¼‰
5. **æŠ€æœ¯å®æ–½**ï¼ˆ2-3å¤©ï¼‰
6. **å†…å®¹è¿ç§»å’Œä¼˜åŒ–**ï¼ˆ2-3å¤©ï¼‰
7. **æµ‹è¯•å’Œä¸Šçº¿**ï¼ˆ1-2å¤©ï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šExcelå·¥å…·å¼€å‘ï¼ˆ5-7å¤©ï¼‰
1. **Cell-Fill** - è§£å†³æ˜ç¡®ç—›ç‚¹ï¼ŒæŠ€æœ¯å®ç°ç›¸å¯¹ç®€å•
2. **Filter-Counter** - å¸‚åœºéœ€æ±‚å¤§ï¼Œç”¨æˆ·ä»·å€¼é«˜
3. **Text-Grouper** - è¡¥å……åŠŸèƒ½ï¼Œæ•°æ®å¤„ç†ä»·å€¼é«˜
4. **Spotlight** - æœ‰ä»˜è´¹æ½œåŠ›ï¼Œä½†æŠ€æœ¯å¤æ‚åº¦è¾ƒé«˜

### ç¬¬ä¸‰é˜¶æ®µï¼šä¼˜åŒ–å’Œç›‘æ§ï¼ˆæŒç»­è¿›è¡Œï¼‰
1. **è®¾ç½®ç›‘æ§å·¥å…·**
2. **A/Bæµ‹è¯•ä¼˜åŒ–**
3. **æ ¹æ®ç”¨æˆ·åé¦ˆè°ƒæ•´**
4. **SEOæŒç»­ä¼˜åŒ–**

**æ€»é¢„è®¡å¼€å‘æ—¶é—´ï¼š15-21å¤©**

---

## 7. æˆåŠŸæŒ‡æ ‡

### ç½‘ç«™é‡æ„æˆåŠŸæŒ‡æ ‡ï¼š
- é¡µé¢åŠ è½½é€Ÿåº¦æå‡30%
- ç”¨æˆ·åœç•™æ—¶é—´å¢åŠ 50%
- å†…éƒ¨é¡µé¢è·³è½¬ç‡æå‡40%
- æœç´¢å¼•æ“æ”¶å½•é¡µé¢æ•°é‡å¢åŠ 5å€

### Excelå·¥å…·æˆåŠŸæŒ‡æ ‡ï¼š
- å·¥å…·ä½¿ç”¨ç‡è¾¾åˆ°åŸunpivotå·¥å…·çš„20%
- ç”¨æˆ·åœ¨ç½‘ç«™æ€»åœç•™æ—¶é—´å¢åŠ 100%
- ä»˜è´¹è½¬åŒ–ç‡è¾¾åˆ°2-5%ï¼ˆSpotlightå·¥å…·ï¼‰
- å·¥å…·é›†é¡µé¢æœˆè®¿é—®é‡è¾¾åˆ°1000+